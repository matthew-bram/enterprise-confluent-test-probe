# =============================================================================
# Test-Probe Java Quickstart - ConfigMap
# =============================================================================
# Raw Kubernetes manifest - alternative to Helm
apiVersion: v1
kind: ConfigMap
metadata:
  name: quickstart-config
  namespace: quickstart
data:
  application.conf: |
    # Kubernetes deployment configuration
    test-probe {
      core {
        actor-system {
          name = "quickstart"
          timeout = 25s
        }
        kafka {
          bootstrap-servers = "kafka.kafka.svc.cluster.local:9092"
          schema-registry-url = "http://schema-registry.kafka.svc.cluster.local:8081"
        }
        dsl {
          ask-timeout = 3s
        }
      }
      services {
        vault {
          provider = "local"
          local.required-fields = ["clientId", "clientSecret"]
        }
        block-storage {
          provider = "local"
          topic-directive-file-name = "topic-directive.yaml"
        }
      }
    }
    pekko {
      loglevel = "INFO"
    }

  topic-directive.yaml: |
    topics:
      - topic: "order-events-json"
        role: "producer"
        clientPrincipal: "quickstart-producer"
        eventFilters:
          - key: "OrderEvent"
            value: "1.0"
      - topic: "order-events-json"
        role: "consumer"
        clientPrincipal: "quickstart-consumer"
        eventFilters:
          - key: "OrderEvent"
            value: "1.0"
      - topic: "inventory-events-avro"
        role: "producer"
        clientPrincipal: "quickstart-producer"
        eventFilters:
          - key: "InventoryEvent"
            value: "1.0"
      - topic: "inventory-events-avro"
        role: "consumer"
        clientPrincipal: "quickstart-consumer"
        eventFilters:
          - key: "InventoryEvent"
            value: "1.0"
      - topic: "payment-events-protobuf"
        role: "producer"
        clientPrincipal: "quickstart-producer"
        eventFilters:
          - key: "PaymentEvent"
            value: "1.0"
      - topic: "payment-events-protobuf"
        role: "consumer"
        clientPrincipal: "quickstart-consumer"
        eventFilters:
          - key: "PaymentEvent"
            value: "1.0"
